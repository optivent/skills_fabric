## Publishing and Release Management
link

The [`oh-my-opencode`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/README.md?plain=1#L328) repository includes mechanisms for managing its npm package, ensuring a streamlined release process. This involves automated versioning, generation of release notes, and integration with GitHub Actions to facilitate consistent publication. The system also supports identifying changes that have not yet been published.
The project leverages scripts to support this workflow. For instance, [`script/build-schema.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/build-schema.ts) generates a formatted JSON Schema file, crucial for maintaining configuration consistency across the application. Another script, [`script/generate-changelog.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/generate-changelog.ts), automates the creation of release notes by summarizing recent commits and recognizing community contributions since the last release.
The core publishing process, detailed in [`script/publish.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts), handles the entire lifecycle of a release. This includes determining the new package version, updating the [`package.json`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/README.md?plain=1#L371) file, and publishing the package to npm. It also manages Git tagging and the creation of GitHub releases, ensuring that changelogs and contributor information are correctly included. This script utilizes external tools like [`bun`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/bun.lock#L28) for execution, [`gh`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/README.md?plain=1#L429) for GitHub interactions, and [`git`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/README.md?plain=1#L623) for version control, to manage the release process.
A command, defined in [`.opencode/command/get-unpublished-changes.md`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/.opencode/command/get-unpublished-changes.md), allows for the identification and summary of all changes made since the last npm publication. This command categorizes changes by commit type, highlights breaking changes, and recommends an appropriate version bump ([`major`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts#L25), [`minor`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts#L25), or [`patch`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts#L25)) based on the nature of the modifications. This structured overview helps in preparing for releases and communicating changes effectively.
The publishing workflow, as outlined in [`.opencode/command/publish.md`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/.opencode/command/publish.md), is designed to be executed by a release manager and includes validation steps, pre-publish checks, and monitoring of GitHub Actions. It ensures synchronization with the remote repository and verifies the release on both GitHub and npm. A notable feature is the dynamic drafting and prepending of enhanced release notes to the GitHub release body, adhering to a "ZERO CONTENT LOSS POLICY." The system also incorporates robust error handling and, for specific user bases, localized interactions in Korean.
### Automated Publishing Workflow
link

The automated publishing workflow for the [`oh-my-opencode`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/README.md?plain=1#L328) npm package streamlines the release process by handling version management, pre-publication checks, and integration with GitHub Actions. This system is defined in the script located at [`script/publish.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts) and further orchestrated by the command defined in [`.opencode/command/publish.md`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/.opencode/command/publish.md).
The process begins with validating the desired version bump type (patch, minor, or major) to ensure controlled releases. Before any publication steps, the system performs a series of pre-publish checks. These checks verify that there are no uncommitted changes or unpushed commits in the local repository, enforcing synchronization with the remote to prevent inconsistencies.
The core of the automation involves triggering and monitoring a dedicated GitHub Actions workflow. Once the workflow is initiated, the system polls its status until completion. This monitoring includes handling failures by providing access to detailed logs, which assists in diagnosing and resolving any issues during the publication process.
Following the successful execution of the GitHub Actions workflow, the system verifies the creation of a new GitHub release corresponding to the new package version. It then generates enhanced release notes dynamically, adapting the content based on the type of version bump. For instance, a patch release might focus on simple commit messages, while a major release could include a more comprehensive changelog. These new notes are then prepended to the existing GitHub release body, ensuring that no prior content is lost. Finally, the system confirms the successful publication of the new package version to the npm registry. The entire process incorporates robust error handling strategies to address various failure scenarios, such as workflow failures, missing releases, or npm propagation delays. For more details on identifying unpublished changes, refer to [Identifying Unpublished Changes and Version Bump Recommendations](https://codewiki.google/github.com/code-yeongyu/oh-my-opencode#publishing-and-release-management-identifying-unpublished-changes-and-version-bump-recommendations). The specific scripts facilitating this are located within the [`script`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script) directory.
### Automated Changelog and Release Note Generation
link

The [`oh-my-opencode`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/README.md?plain=1#L328) repository automates the generation of release notes and changelogs, a critical part of its [Publishing and Release Management](https://codewiki.google/github.com/code-yeongyu/oh-my-opencode#publishing-and-release-management) workflow. This process involves identifying changes and community contributions between the latest released version and the current development state.
The script responsible for this automation, located at [`script/generate-changelog.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/generate-changelog.ts), is designed to create a summary of recent commits and acknowledge external contributors. It begins by determining the most recent official release tag using GitHub's release information. Once the baseline is established, the script analyzes the Git commit history between that tag and the current [`HEAD`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts#L48). It filters out commits related to internal processes like testing, chores, or CI/CD, focusing instead on changes that are relevant to users or directly impact the project's functionality. These filtered commit messages form the core of the changelog entries.
Beyond technical changes, the system also identifies community contributions. It queries the GitHub API to compare commit authors in the relevant timeframe, distinguishing external contributors from internal team members. Their contributions are then listed alongside the changelog entries, recognizing their impact on the project. This consolidated information is then used to generate release notes, which can be integrated into GitHub releases. The main orchestrating function of this process is [`main()`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts#L162) in [`script/generate-changelog.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/generate-changelog.ts), which calls upon various sub-functions to fetch tags, generate changelog entries, and identify contributors. A similar set of functionalities is integrated into the [`script/publish.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts) script to ensure that each new release automatically includes an up-to-date changelog and contributor list.
### Identifying Unpublished Changes and Version Bump Recommendations
link

A command within the [`oh-my-opencode`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/README.md?plain=1#L328) CLI is available to summarize changes made since the last npm publication, providing insights for release management. This command compares the current [`HEAD`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts#L48) of the repository with the version most recently published to npm, identifying all modifications. It categorizes these changes into standard commit types such as features ([`feat`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/.opencode/command/get-unpublished-changes.md?plain=1#L55)), bug fixes ([`fix`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/.opencode/command/get-unpublished-changes.md?plain=1#L60)), code refactorings ([`refactor`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/.opencode/command/get-unpublished-changes.md?plain=1#L65)), and documentation updates ([`docs`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/.opencode/command/get-unpublished-changes.md?plain=1#L70)). For each identified change, the system generates a description focusing on the actual modification and its significance, rather than simply reiterating commit messages. The process also includes identifying any breaking changes introduced since the last release. Based on the aggregate of these categorized changes and the presence of breaking changes, the command recommends an appropriate version bumpâ€”[`major`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts#L25), [`minor`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts#L25), or [`patch`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/script/publish.ts#L25). This functionality is primarily defined in [`.opencode/command/get-unpublished-changes.md`](https://github.com/code-yeongyu/oh-my-opencode/blob/d0694e5aa4ecd5e0179718e190136f8b213200d9/.opencode/command/get-unpublished-changes.md) and serves as a tool for ensuring clear communication and consistent versioning in the release process. Related details about the automated publishing workflow can be found in [Automated Publishing Workflow](https://codewiki.google/github.com/code-yeongyu/oh-my-opencode#publishing-and-release-management-automated-publishing-workflow).
[FAQ](https://codewiki.google/faq) Feedback [ Terms ](https://policies.google.com/terms)[ Privacy ](https://policies.google.com/privacy)
Toggle theme. Current: Dark
Share

View on GitHub
