# SOURCE: https://github.com/shekohex/opencode-pty

[Skip to content](https://github.com/shekohex/opencode-pty#start-of-content)
## Navigation Menu
Toggle navigation
[ ](https://github.com/)
[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fshekohex%2Fopencode-pty)
Appearance settings
  * Platform
    * AI CODE CREATION
      * [ GitHub CopilotWrite better code with AI ](https://github.com/features/copilot)
      * [ GitHub SparkBuild and deploy intelligent apps ](https://github.com/features/spark)
      * [ GitHub ModelsManage and compare prompts ](https://github.com/features/models)
      * [ MCP RegistryNewIntegrate external tools ](https://github.com/mcp)
    * DEVELOPER WORKFLOWS
      * [ ActionsAutomate any workflow ](https://github.com/features/actions)
      * [ CodespacesInstant dev environments ](https://github.com/features/codespaces)
      * [ IssuesPlan and track work ](https://github.com/features/issues)
      * [ Code ReviewManage code changes ](https://github.com/features/code-review)
    * APPLICATION SECURITY
      * [ GitHub Advanced SecurityFind and fix vulnerabilities ](https://github.com/security/advanced-security)
      * [ Code securitySecure your code as you build ](https://github.com/security/advanced-security/code-security)
      * [ Secret protectionStop leaks before they start ](https://github.com/security/advanced-security/secret-protection)
    * EXPLORE
      * [Why GitHub](https://github.com/why-github)
      * [Documentation](https://docs.github.com)
      * [Blog](https://github.blog)
      * [Changelog](https://github.blog/changelog)
      * [Marketplace](https://github.com/marketplace)
[View all features](https://github.com/features)
  * Solutions
    * BY COMPANY SIZE
      * [Enterprises](https://github.com/enterprise)
      * [Small and medium teams](https://github.com/team)
      * [Startups](https://github.com/enterprise/startups)
      * [Nonprofits](https://github.com/solutions/industry/nonprofits)
    * BY USE CASE
      * [App Modernization](https://github.com/solutions/use-case/app-modernization)
      * [DevSecOps](https://github.com/solutions/use-case/devsecops)
      * [DevOps](https://github.com/solutions/use-case/devops)
      * [CI/CD](https://github.com/solutions/use-case/ci-cd)
      * [View all use cases](https://github.com/solutions/use-case)
    * BY INDUSTRY
      * [Healthcare](https://github.com/solutions/industry/healthcare)
      * [Financial services](https://github.com/solutions/industry/financial-services)
      * [Manufacturing](https://github.com/solutions/industry/manufacturing)
      * [Government](https://github.com/solutions/industry/government)
      * [View all industries](https://github.com/solutions/industry)
[View all solutions](https://github.com/solutions)
  * Resources
    * EXPLORE BY TOPIC
      * [AI](https://github.com/resources/articles?topic=ai)
      * [Software Development](https://github.com/resources/articles?topic=software-development)
      * [DevOps](https://github.com/resources/articles?topic=devops)
      * [Security](https://github.com/resources/articles?topic=security)
      * [View all topics](https://github.com/resources/articles)
    * EXPLORE BY TYPE
      * [Customer stories](https://github.com/customer-stories)
      * [Events & webinars](https://github.com/resources/events)
      * [Ebooks & reports](https://github.com/resources/whitepapers)
      * [Business insights](https://github.com/solutions/executive-insights)
      * [GitHub Skills](https://skills.github.com)
    * SUPPORT & SERVICES
      * [Documentation](https://docs.github.com)
      * [Customer support](https://support.github.com)
      * [Community forum](https://github.com/orgs/community/discussions)
      * [Trust center](https://github.com/trust-center)
      * [Partners](https://github.com/partners)
  * Open Source
    * COMMUNITY
      * [ GitHub SponsorsFund open source developers ](https://github.com/sponsors)
    * PROGRAMS
      * [Security Lab](https://securitylab.github.com)
      * [Maintainer Community](https://maintainers.github.com)
      * [Accelerator](https://github.com/accelerator)
      * [Archive Program](https://archiveprogram.github.com)
    * REPOSITORIES
      * [Topics](https://github.com/topics)
      * [Trending](https://github.com/trending)
      * [Collections](https://github.com/collections)
  * Enterprise
    * ENTERPRISE SOLUTIONS
      * [ Enterprise platformAI-powered developer platform ](https://github.com/enterprise)
    * AVAILABLE ADD-ONS
      * [ GitHub Advanced SecurityEnterprise-grade security features ](https://github.com/security/advanced-security)
      * [ Copilot for BusinessEnterprise-grade AI features ](https://github.com/features/copilot/copilot-business)
      * [ Premium SupportEnterprise-grade 24/7 support ](https://github.com/premium-support)
  * [Pricing](https://github.com/pricing)


Search or jump to...
# Search code, repositories, users, issues, pull requests...
Search 
Clear
[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)
#  Provide feedback 
We read every piece of feedback, and take your input very seriously.
Include my email address so I can be contacted
Cancel  Submit feedback 
#  Saved searches 
## Use saved searches to filter your results more quickly
Name
Query
To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax). 
Cancel  Create saved search 
[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fshekohex%2Fopencode-pty)
[ Sign up ](https://github.com/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=shekohex%2Fopencode-pty)
Appearance settings
Resetting focus
You signed in with another tab or window. [Reload](https://github.com/shekohex/opencode-pty) to refresh your session. You signed out in another tab or window. [Reload](https://github.com/shekohex/opencode-pty) to refresh your session. You switched accounts on another tab or window. [Reload](https://github.com/shekohex/opencode-pty) to refresh your session. Dismiss alert
{{ message }}
[ shekohex ](https://github.com/shekohex) / **[opencode-pty](https://github.com/shekohex/opencode-pty) ** Public
  * [ ](https://github.com/login?return_to=%2Fshekohex%2Fopencode-pty) You must be signed in to change notification settings
  * [ 4 ](https://github.com/login?return_to=%2Fshekohex%2Fopencode-pty)
  * [ Star  43 ](https://github.com/login?return_to=%2Fshekohex%2Fopencode-pty)


OpenCode plugin for interactive PTY management - run background processes, send input, read output with regex filtering 
### License
[ ](https://github.com/shekohex/opencode-pty/blob/main/LICENSE)
[ 43 stars ](https://github.com/shekohex/opencode-pty/stargazers) [ 4 forks ](https://github.com/shekohex/opencode-pty/forks) [ Branches ](https://github.com/shekohex/opencode-pty/branches) [ Tags ](https://github.com/shekohex/opencode-pty/tags) [ Activity ](https://github.com/shekohex/opencode-pty/activity)
[ Star  ](https://github.com/login?return_to=%2Fshekohex%2Fopencode-pty)
[ ](https://github.com/login?return_to=%2Fshekohex%2Fopencode-pty) You must be signed in to change notification settings
  * [ Code ](https://github.com/shekohex/opencode-pty)
  * [ Issues 1 ](https://github.com/shekohex/opencode-pty/issues)
  * [ Pull requests 1 ](https://github.com/shekohex/opencode-pty/pulls)
  * [ Actions ](https://github.com/shekohex/opencode-pty/actions)
  * [ Projects 0 ](https://github.com/shekohex/opencode-pty/projects)
  * [ Security ](https://github.com/shekohex/opencode-pty/security)
[ ](https://github.com/shekohex/opencode-pty/security)
[ ](https://github.com/shekohex/opencode-pty/security)
[ ](https://github.com/shekohex/opencode-pty/security)
### [ Uh oh!  ](https://github.com/shekohex/opencode-pty/security)
[There was an error while loading. ](https://github.com/shekohex/opencode-pty/security)[Please reload this page](https://github.com/shekohex/opencode-pty).
  * [ Insights ](https://github.com/shekohex/opencode-pty/pulse)


Additional navigation options
  * [ Code  ](https://github.com/shekohex/opencode-pty)
  * [ Issues  ](https://github.com/shekohex/opencode-pty/issues)
  * [ Pull requests  ](https://github.com/shekohex/opencode-pty/pulls)
  * [ Actions  ](https://github.com/shekohex/opencode-pty/actions)
  * [ Projects  ](https://github.com/shekohex/opencode-pty/projects)
  * [ Security  ](https://github.com/shekohex/opencode-pty/security)
  * [ Insights  ](https://github.com/shekohex/opencode-pty/pulse)


# shekohex/opencode-pty
main
[Branches](https://github.com/shekohex/opencode-pty/branches)[Tags](https://github.com/shekohex/opencode-pty/tags)
[](https://github.com/shekohex/opencode-pty/branches)[](https://github.com/shekohex/opencode-pty/tags)
Go to file
Code
Open more actions menu
## Folders and files
Name | Name | Last commit message | Last commit date  
---|---|---|---  
## Latest commit
## History
[5 Commits](https://github.com/shekohex/opencode-pty/commits/main/)[](https://github.com/shekohex/opencode-pty/commits/main/)  
[.github](https://github.com/shekohex/opencode-pty/tree/main/.github ".github") | [.github](https://github.com/shekohex/opencode-pty/tree/main/.github ".github") |  |   
[src](https://github.com/shekohex/opencode-pty/tree/main/src "src") | [src](https://github.com/shekohex/opencode-pty/tree/main/src "src") |  |   
[.gitattributes](https://github.com/shekohex/opencode-pty/blob/main/.gitattributes ".gitattributes") | [.gitattributes](https://github.com/shekohex/opencode-pty/blob/main/.gitattributes ".gitattributes") |  |   
[.gitignore](https://github.com/shekohex/opencode-pty/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/shekohex/opencode-pty/blob/main/.gitignore ".gitignore") |  |   
[LICENSE](https://github.com/shekohex/opencode-pty/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/shekohex/opencode-pty/blob/main/LICENSE "LICENSE") |  |   
[README.md](https://github.com/shekohex/opencode-pty/blob/main/README.md "README.md") | [README.md](https://github.com/shekohex/opencode-pty/blob/main/README.md "README.md") |  |   
[bun.lock](https://github.com/shekohex/opencode-pty/blob/main/bun.lock "bun.lock") | [bun.lock](https://github.com/shekohex/opencode-pty/blob/main/bun.lock "bun.lock") |  |   
[index.ts](https://github.com/shekohex/opencode-pty/blob/main/index.ts "index.ts") | [index.ts](https://github.com/shekohex/opencode-pty/blob/main/index.ts "index.ts") |  |   
[package.json](https://github.com/shekohex/opencode-pty/blob/main/package.json "package.json") | [package.json](https://github.com/shekohex/opencode-pty/blob/main/package.json "package.json") |  |   
[release.sh](https://github.com/shekohex/opencode-pty/blob/main/release.sh "release.sh") | [release.sh](https://github.com/shekohex/opencode-pty/blob/main/release.sh "release.sh") |  |   
[tsconfig.json](https://github.com/shekohex/opencode-pty/blob/main/tsconfig.json "tsconfig.json") | [tsconfig.json](https://github.com/shekohex/opencode-pty/blob/main/tsconfig.json "tsconfig.json") |  |   
View all files  
## Repository files navigation
  * [README](https://github.com/shekohex/opencode-pty)
  * [MIT license](https://github.com/shekohex/opencode-pty)


# opencode-pty
[](https://github.com/shekohex/opencode-pty#opencode-pty)
A plugin for [OpenCode](https://opencode.ai) that provides interactive PTY (pseudo-terminal) management, enabling the AI agent to run background processes, send interactive input, and read output on demand.
## Why?
[](https://github.com/shekohex/opencode-pty#why)
OpenCode's built-in `bash` tool runs commands synchronously—the agent waits for completion. This works for quick commands, but not for:
  * **Dev servers** (`npm run dev`, `cargo watch`)
  * **Watch modes** (`npm test -- --watch`)
  * **Long-running processes** (database servers, tunnels)
  * **Interactive programs** (REPLs, prompts)


This plugin gives the agent full control over multiple terminal sessions, like tabs in a terminal app.
## Features
[](https://github.com/shekohex/opencode-pty#features)
  * **Background Execution** : Spawn processes that run independently
  * **Multiple Sessions** : Manage multiple PTYs simultaneously
  * **Interactive Input** : Send keystrokes, Ctrl+C, arrow keys, etc.
  * **Output Buffer** : Read output anytime with pagination (offset/limit)
  * **Pattern Filtering** : Search output using regex (like `grep`)
  * **Permission Support** : Respects OpenCode's bash permission settings
  * **Session Lifecycle** : Sessions persist until explicitly killed
  * **Auto-cleanup** : PTYs are cleaned up when OpenCode sessions end


## Setup
[](https://github.com/shekohex/opencode-pty#setup)
Add the plugin to your [OpenCode config](https://opencode.ai/docs/config/):
```
{
  "$schema": "https://opencode.ai/config.json",
  "plugin": ["opencode-pty"]
}
```

That's it. OpenCode will automatically install the plugin on next run.
## Updating
[](https://github.com/shekohex/opencode-pty#updating)
OpenCode does NOT auto-update plugins.
To get the latest version, clear the cached plugin and let OpenCode reinstall it:
```
rm -rf ~/.cache/opencode/node_modules/opencode-pty
opencode
```

## Tools Provided
[](https://github.com/shekohex/opencode-pty#tools-provided)
Tool | Description  
---|---  
`pty_spawn` | Create a new PTY session (command, args, workdir, env, title)  
`pty_write` | Send input to a PTY (text, escape sequences like `\x03` for Ctrl+C)  
`pty_read` | Read output buffer with pagination and optional regex filtering  
`pty_list` | List all PTY sessions with status, PID, line count  
`pty_kill` | Terminate a PTY, optionally cleanup the buffer  
## Usage Examples
[](https://github.com/shekohex/opencode-pty#usage-examples)
### Start a dev server
[](https://github.com/shekohex/opencode-pty#start-a-dev-server)
```
pty_spawn: command="npm", args=["run", "dev"], title="Dev Server"
→ Returns: pty_a1b2c3d4

```

### Check server output
[](https://github.com/shekohex/opencode-pty#check-server-output)
```
pty_read: id="pty_a1b2c3d4", limit=50
→ Shows last 50 lines of output

```

### Filter for errors
[](https://github.com/shekohex/opencode-pty#filter-for-errors)
```
pty_read: id="pty_a1b2c3d4", pattern="error|ERROR", ignoreCase=true
→ Shows only lines matching the pattern

```

### Send Ctrl+C to stop
[](https://github.com/shekohex/opencode-pty#send-ctrlc-to-stop)
```
pty_write: id="pty_a1b2c3d4", data="\x03"
→ Sends interrupt signal

```

### Kill and cleanup
[](https://github.com/shekohex/opencode-pty#kill-and-cleanup)
```
pty_kill: id="pty_a1b2c3d4", cleanup=true
→ Terminates process and frees buffer

```

## Configuration
[](https://github.com/shekohex/opencode-pty#configuration)
### Environment Variables
[](https://github.com/shekohex/opencode-pty#environment-variables)
Variable | Default | Description  
---|---|---  
`PTY_MAX_BUFFER_LINES` | `50000` | Maximum lines to keep in output buffer per session  
### Permissions
[](https://github.com/shekohex/opencode-pty#permissions)
This plugin respects OpenCode's [permission settings](https://opencode.ai/docs/permissions/) for the `bash` tool. Commands spawned via `pty_spawn` are checked against your `permission.bash` configuration.
```
{
  "$schema": "https://opencode.ai/config.json",
  "permission": {
    "bash": {
      "npm *": "allow",
      "git push": "deny",
      "terraform *": "deny"
    }
  }
}
```

**Limitations compared to built-in bash tool:**
  * **"ask" permissions are treated as "deny"** : Since plugins cannot trigger OpenCode's permission prompt UI, commands matching an "ask" pattern will be denied. A toast notification will inform you when this happens. Configure explicit "allow" or "deny" for commands you want to use with PTY.
  * **"external_directory" with "ask" is treated as "allow"** : When the working directory is outside the project and `permission.external_directory` is set to "ask", this plugin allows it (with a log message). Set to "deny" explicitly if you want to block external directories.


#### Example: Allow specific commands for PTY
[](https://github.com/shekohex/opencode-pty#example-allow-specific-commands-for-pty)
```
{
  "$schema": "https://opencode.ai/config.json",
  "permission": {
    "bash": {
      "npm run dev": "allow",
      "npm run build": "allow",
      "npm test *": "allow",
      "cargo *": "allow",
      "python *": "allow"
    }
  }
}
```

## How It Works
[](https://github.com/shekohex/opencode-pty#how-it-works)
  1. **Spawn** : Creates a PTY using [bun-pty](https://github.com/nicksrandall/bun-pty), runs command in background
  2. **Buffer** : Output is captured into a rolling line buffer (ring buffer)
  3. **Read** : Agent can read buffer anytime with offset/limit pagination
  4. **Filter** : Optional regex pattern filters lines before pagination
  5. **Write** : Agent can send any input including escape sequences
  6. **Lifecycle** : Sessions track status (running/exited/killed), persist until cleanup


## Session Lifecycle
[](https://github.com/shekohex/opencode-pty#session-lifecycle)
```
spawn → running → [exited | killed]
                      ↓
              (stays in list until cleanup=true)

```

Sessions remain in the list after exit so the agent can:
  * Read final output
  * Check exit code
  * Compare logs between runs


Use `pty_kill` with `cleanup=true` to remove completely.
## Local Development
[](https://github.com/shekohex/opencode-pty#local-development)
```
git clone https://github.com/shekohex/opencode-pty.git
cd opencode-pty
bun install
bun run tsc --noEmit  # Type check
```

To load a local checkout in OpenCode:
```
{
  "$schema": "https://opencode.ai/config.json",
  "plugin": ["file:///absolute/path/to/opencode-pty"]
}
```

## License
[](https://github.com/shekohex/opencode-pty#license)
MIT
## Contributing
[](https://github.com/shekohex/opencode-pty#contributing)
Contributions are welcome! Please open an issue or submit a PR.
## Credits
[](https://github.com/shekohex/opencode-pty#credits)
  * [OpenCode](https://opencode.ai) - The AI coding assistant this plugin extends
  * [bun-pty](https://github.com/nicksrandall/bun-pty) - Cross-platform PTY for Bun


## About
OpenCode plugin for interactive PTY management - run background processes, send input, read output with regex filtering 
### Topics
[ cli ](https://github.com/topics/cli "Topic: cli") [ typescript ](https://github.com/topics/typescript "Topic: typescript") [ terminal ](https://github.com/topics/terminal "Topic: terminal") [ opencode ](https://github.com/topics/opencode "Topic: opencode") [ pty ](https://github.com/topics/pty "Topic: pty") [ bun ](https://github.com/topics/bun "Topic: bun") [ background-process ](https://github.com/topics/background-process "Topic: background-process") [ opencode-plugin ](https://github.com/topics/opencode-plugin "Topic: opencode-plugin")
### Resources
[ ](https://github.com/shekohex/opencode-pty#readme-ov-file)
### License
[ ](https://github.com/shekohex/opencode-pty#MIT-1-ov-file)
###  Uh oh! 
There was an error while loading. [Please reload this page](https://github.com/shekohex/opencode-pty).
[Activity](https://github.com/shekohex/opencode-pty/activity)
### Stars
[**43** stars](https://github.com/shekohex/opencode-pty/stargazers)
### Watchers
[**2** watching](https://github.com/shekohex/opencode-pty/watchers)
### Forks
[**4** forks](https://github.com/shekohex/opencode-pty/forks)
[ Report repository ](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fshekohex%2Fopencode-pty&report=shekohex+%28user%29)
##  [Releases 4](https://github.com/shekohex/opencode-pty/releases)
[ v0.1.1 Latest  Dec 30, 2025 ](https://github.com/shekohex/opencode-pty/releases/tag/v0.1.1)
[+ 3 releases](https://github.com/shekohex/opencode-pty/releases)
##  [Packages 0](https://github.com/users/shekohex/packages?repo_name=opencode-pty)
No packages published   

###  Uh oh! 
There was an error while loading. [Please reload this page](https://github.com/shekohex/opencode-pty).
##  [Contributors 2](https://github.com/shekohex/opencode-pty/graphs/contributors)
  * [ ![@shekohex](https://avatars.githubusercontent.com/u/14620076?s=64&v=4) ](https://github.com/shekohex) [ **shekohex** ](https://github.com/shekohex)
  * [ ![@R44VC0RP](https://avatars.githubusercontent.com/u/89211796?s=64&v=4) ](https://github.com/R44VC0RP) [ **R44VC0RP** Ryan Vogel ](https://github.com/R44VC0RP)


## Languages
  * [ TypeScript 84.1% ](https://github.com/shekohex/opencode-pty/search?l=typescript)
  * [ Shell 15.9% ](https://github.com/shekohex/opencode-pty/search?l=shell)


## Footer
[ ](https://github.com) © 2025 GitHub, Inc. 
### Footer navigation
  * [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
  * [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  * [Security](https://github.com/security)
  * [Status](https://www.githubstatus.com/)
  * [Community](https://github.community/)
  * [Docs](https://docs.github.com/)
  * [Contact](https://support.github.com?tags=dotcom-footer)
  * Manage cookies 
  * Do not share my personal information 


